<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Earnings - LearnNest</title>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="stylesheet" href="Dashboard-Home.css">
  <style> 
    :root {
  --bg-dark: #000000;
  --bg-card: #111111;
  --text-light: #ffffff;
  --accent-blue: deepskyblue;
}
body {
  margin: 0;
  background-color: var(--bg-dark);
  color: var(--text-light);
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}

.sidebar {
  height: 100vh;
  background-color: #0a0a0a;
  padding: 20px;
  position: fixed;
  top: 0;
  left: 0;
  width: 240px;
  overflow-y: auto;
  transition: transform 0.3s ease-in-out;
  z-index: 1000;
}
.sidebar h2 {
  font-size: 1.2rem;
  margin-bottom: 30px;
  margin-top: 15px;
  /* margin-left: 35px; */
  color: var(--accent-blue);
}
.sidebar a {
  display: block;
  color: var(--text-light);
  padding: 10px 15px;
  border-radius: 10px;
  margin-bottom: 10px;
  text-decoration: none;
  transition: 0.2s;
}
.sidebar a:hover {
  background-color: var(--bg-card);
  color: var(--accent-blue);
  box-shadow: inset 0 0 10px var(--accent-blue);
}

.sidebar a.active {
  background-color: var(--accent-blue);
  color: var(--text-light);
  font-weight: bold;
}

.main {
  margin-left: 240px;
  padding: 20px;
}

@media print {
  body * {
    visibility: hidden;
  }
  #invoiceModal, #invoiceModal * {
    visibility: visible;
  }
  #invoiceModal {
    position: absolute;
    left: 0;
    top: 0;
    width: 100% !important;
    height: auto !important;
    overflow: visible;
  }
  .modal-footer, .btn-close {
    display: none;
  }
}

   </style>
</head>
<body>
  <button class="sidebar-toggle-btn" onclick="toggleSidebar()">â˜°</button>
  <div class="sidebar" id="sidebar">
    <h2>LearnNest by Technify</h2>
    <a href="Dashboard-Home.html"><i class="fas fa-chart-line"></i> Dashboard</a>
    <a href="My-Courses.html" ><i class="fas fa-book"></i> My Courses</a>
    <a href="Create-Course.html"><i class="fa-solid fa-square-plus"></i> Create Course</a>
    <a href="Students.html"><i class="fas fa-user-graduate"></i> Students</a>
    <a href="Earnings.html" class="active"><i class="fas fa-wallet"></i> Earnings</a>
    <a href="Profile.html"><i class="fas fa-user"></i> Profile</a>
    <a href="Settings.html"><i class="fas fa-cog"></i> Settings</a>
  </div>
  <!-- Add this to your Earnings.html file -->
<div class="main">
    <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
        <h2 class="text-info mb-0">Earnings Report</h2>
        <div class="d-flex gap-2 mt-2 mt-md-0">
            <button id="exportEarningsBtn" class="btn btn-success btn-sm">
                <i class="fas fa-file-export"></i> Export CSV
            </button>
            <button class="btn btn-outline-light btn-sm" onclick="fetchEarnings()">
                <i class="fas fa-sync"></i> Refresh
            </button>
        </div>
    </div>

    <!-- Filters -->
    <div class="row mb-3 g-2">
        <div class="col-md-2 col-6">
            <label class="form-label small text-secondary mb-1">Show Rows</label>
            <select id="earningsPerPage" class="form-select form-select-sm bg-dark text-light border-secondary">
                <option value="10">10</option>
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
            </select>
        </div>
        <div class="col-md-3 col-6">
            <label class="form-label small text-secondary mb-1">Course</label>
            <select id="earningsCourseFilter" class="form-select form-select-sm bg-dark text-light border-secondary">
                <option value="">All Courses</option>
                <!-- Populated by JS -->
            </select>
        </div>
        <div class="col-md-2 col-6">
            <label class="form-label small text-secondary mb-1">Status</label>
            <select id="earningsStatusFilter" class="form-select form-select-sm bg-dark text-light border-secondary">
                <option value="">All Statuses</option>
                <!-- Populated by JS -->
            </select>
        </div>
        <div class="col-md-2 col-6">
            <label class="form-label small text-secondary mb-1">Payment Method</label>
            <select id="earningsMethodFilter" class="form-select form-select-sm bg-dark text-light border-secondary">
                <option value="">All Methods</option>
                <!-- Populated by JS -->
            </select>
        </div>
        <div class="col-md-3 col-6">
            <label class="form-label small text-secondary mb-1">Date From</label>
            <input type="date" id="earningsDateFrom" class="form-control form-control-sm bg-dark text-light border-secondary">
        </div>
        <div class="col-md-3 col-6">
            <label class="form-label small text-secondary mb-1">Date To</label>
            <input type="date" id="earningsDateTo" class="form-control form-control-sm bg-dark text-light border-secondary">
        </div>
        <div class="col-md-6 col-12">
            <label class="form-label small text-secondary mb-1">Search</label>
            <input type="text" id="earningsSearch" class="form-control form-control-sm bg-dark text-light border-secondary" 
                   placeholder="Search students or courses...">
        </div>
    </div>

    <!-- Earnings Table -->
    <div class="table-responsive">
        <table class="table table-dark table-striped table-hover align-middle">
            <thead class="text-uppercase small text-secondary">
                <tr>
                    <th>#</th>
                    <th data-sort="student_name">Student <i class="fas fa-sort ms-2"></i></th>
                    <th data-sort="course_name">Course <i class="fas fa-sort ms-2"></i></th>
                    <th data-sort="amount">Amount <i class="fas fa-sort ms-2"></i></th>
                    <th data-sort="transaction_date">Date <i class="fas fa-sort ms-2"></i></th>
                    <th>Status</th>
                    <th>Payment Method</th>
                    <th>Invoice</th>
                </tr>
            </thead>
            <tbody id="earningsTableBody">
                <tr>
                    <td colspan="8" class="text-center text-muted">Loading earnings data...</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="d-flex justify-content-center mt-3">
        <div id="earningsPagination" class="btn-group btn-group-sm"></div>
    </div>
</div>

<!-- Error Toast -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1100">
    <div id="errorToast" class="toast bg-danger text-white" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body"></div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>

<!-- Invoice Modal -->
<div class="modal fade" id="invoiceModal" tabindex="-1" aria-labelledby="invoiceModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="invoiceModalLabel">Invoice Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="invoiceContent">
        <div class="invoice-container p-4">
          <div class="d-flex justify-content-between mb-3">
            <div>
              <h6 class="mb-1">Invoice ID:</h6>
              <p id="inv-id" class="fw-semibold">INV-001</p>
            </div>
            <div class="text-end">
              <h6 class="mb-1">Date:</h6>
              <p id="inv-date">2025-07-18</p>
            </div>
          </div>

          <hr>

          <div class="mb-3">
            <h6 class="mb-1">Student Name:</h6>
            <p id="inv-student">John Doe</p>
          </div>

          <div class="mb-3">
            <h6 class="mb-1">Course:</h6>
            <p id="inv-course">Frontend Development</p>
          </div>

          <div class="row mb-3">
            <div class="col-md-6">
              <h6 class="mb-1">Payment Status:</h6>
              <p id="inv-status">Completed</p>
            </div>
            <div class="col-md-6">
              <h6 class="mb-1">Payment Method:</h6>
              <p id="inv-method">PayPal</p>
            </div>
          </div>

          <div class="bg-light rounded p-3 text-center">
            <h4>Total Amount:</h4>
            <p id="inv-amount" class="h4 fw-bold text-success">$120.00</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
    <button type="button" class="btn btn-outline-primary" onclick="downloadInvoice()">
        <i class="fas fa-download"></i> Download Invoice
    </button>
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
</div>
    </div>
  </div>
</div>

<!-- Include the JavaScript -->
<script src="earnings.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("open");
    }
  </script>
</body>
</html>

